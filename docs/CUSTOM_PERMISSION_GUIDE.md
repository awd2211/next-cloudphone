# å®šåˆ¶åŒ–æƒé™ç³»ç»Ÿä½¿ç”¨æŒ‡å—

æ ¹æ®æ‚¨çš„ä¸šåŠ¡éœ€æ±‚å®šåˆ¶çš„ä¼ä¸šçº§æƒé™ç³»ç»Ÿï¼Œæ”¯æŒ **B2B + B2C + ä»£ç†å•† + å¼€å‘è€…** å¤šç§ç”¨æˆ·ç±»å‹ã€‚

---

## ğŸ“‹ ç›®å½•

1. [ä¸šåŠ¡åœºæ™¯æ¦‚è¿°](#ä¸šåŠ¡åœºæ™¯æ¦‚è¿°)
2. [è§’è‰²ä½“ç³»](#è§’è‰²ä½“ç³»)
3. [æƒé™åˆ—è¡¨](#æƒé™åˆ—è¡¨)
4. [æ•°æ®èŒƒå›´ç­–ç•¥](#æ•°æ®èŒƒå›´ç­–ç•¥)
5. [åˆ†çº§è„±æ•ç­–ç•¥](#åˆ†çº§è„±æ•ç­–ç•¥)
6. [åˆå§‹åŒ–æ­¥éª¤](#åˆå§‹åŒ–æ­¥éª¤)
7. [æµ‹è¯•è´¦å·](#æµ‹è¯•è´¦å·)
8. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)

---

## ä¸šåŠ¡åœºæ™¯æ¦‚è¿°

### ç”¨æˆ·ç¾¤ä½“

æ‚¨çš„äº‘æ‰‹æœºå¹³å°æ”¯æŒä»¥ä¸‹ 4 ç±»ç”¨æˆ·ï¼š

1. **ä¼ä¸šå®¢æˆ·ï¼ˆB2Bï¼‰** - ä¼ä¸šæ‰¹é‡è´­ä¹°äº‘æ‰‹æœºï¼Œéœ€è¦ç®¡ç†å¤šä¸ªè®¾å¤‡
2. **ä¸ªäººç”¨æˆ·ï¼ˆB2Cï¼‰** - ä¸ªäººç”¨æˆ·è‡ªä¸»è´­ä¹°ä½¿ç”¨
3. **ä»£ç†å•†/æ¸ é“å•†** - ç®¡ç†ä¸‹çº§å®¢æˆ·ï¼ŒæŸ¥çœ‹åˆ†æ¶¦æ•°æ®
4. **å¼€å‘è€…/APIç”¨æˆ·** - é€šè¿‡ API æ¥å…¥ä½¿ç”¨

### ç»„ç»‡æ¶æ„

- **æ‰å¹³åŒ–ç»„ç»‡**ï¼šæ— éƒ¨é—¨å±‚çº§ï¼Œæ‰€æœ‰ç”¨æˆ·å¹³çº§
- **ç§Ÿæˆ·éš”ç¦»**ï¼šä¸åŒç§Ÿæˆ·æ•°æ®å®Œå…¨éš”ç¦»
- **ä»£ç†å•†ä½“ç³»**ï¼šä»£ç†å•†åªèƒ½æŸ¥çœ‹è‡ªå·±çš„å®¢æˆ·æ•°æ®

### æ•°æ®å®‰å…¨

- **åˆ†çº§è„±æ•**ï¼šä¸åŒè§’è‰²çœ‹åˆ°ä¸åŒç¨‹åº¦çš„è„±æ•æ•°æ®
  - è¶…çº§ç®¡ç†å‘˜/å¹³å°ç®¡ç†å‘˜ï¼šå®Œæ•´æ•°æ®
  - è´¢åŠ¡ç®¡ç†å‘˜ï¼šéƒ¨åˆ†è„±æ•ï¼ˆæ‰‹æœºå·è„±æ•ï¼‰
  - å®¢æœäººå‘˜ï¼šæ›´å¤šè„±æ•ï¼ˆæ‰‹æœºå·ã€é‚®ç®±ã€èº«ä»½è¯ï¼‰
  - æ•°æ®åˆ†æå¸ˆï¼šå®Œå…¨è„±æ•ï¼ˆå“ˆå¸Œå¤„ç†ï¼‰

---

## è§’è‰²ä½“ç³»

### 10 ä¸ªé¢„å®šä¹‰è§’è‰²

| è§’è‰²ä»£ç  | è§’è‰²åç§° | é€‚ç”¨åœºæ™¯ | æ•°æ®èŒƒå›´ |
|----------|----------|----------|----------|
| `super_admin` | Super Admin | å¹³å°åˆå§‹åŒ–ã€ç´§æ€¥ç»´æŠ¤ | å…¨éƒ¨æ•°æ® |
| `platform_admin` | Platform Admin | å¹³å°æ—¥å¸¸è¿è¥ç®¡ç† | ç§Ÿæˆ·æ•°æ® |
| `finance_manager` | Finance Manager | è´¢åŠ¡æ•°æ®ã€è´¦å•ã€åˆ†æ¶¦ç®¡ç† | ç§Ÿæˆ·æ•°æ® |
| `operations_manager` | Operations Manager | ç³»ç»Ÿè¿ç»´ã€è®¾å¤‡èŠ‚ç‚¹ç®¡ç† | ç§Ÿæˆ·æ•°æ® |
| `customer_service` | Customer Service | ç”¨æˆ·å·¥å•ã€æŠ€æœ¯æ”¯æŒ | ç§Ÿæˆ·æ•°æ® |
| `data_analyst` | Data Analyst | è¿è¥æ•°æ®ã€åˆ†ææŠ¥è¡¨ | ç§Ÿæˆ·æ•°æ® |
| `agent` | Agent | ä»£ç†å•†/æ¸ é“å•† | æœ¬äººæ•°æ®ï¼ˆè‡ªå·±çš„å®¢æˆ·ï¼‰ |
| `developer` | Developer | API æ¥å…¥ä½¿ç”¨ | æœ¬äººæ•°æ® |
| `enterprise_user` | Enterprise User | ä¼ä¸šå®¢æˆ· | æœ¬äººæ•°æ® |
| `individual_user` | Individual User | ä¸ªäººç”¨æˆ· | æœ¬äººæ•°æ® |

### è§’è‰²æƒé™å¯¹æ¯”

| åŠŸèƒ½æ¨¡å— | Super Admin | Platform Admin | Finance | Operations | Support | Analyst | Agent | Developer | Enterprise | Individual |
|---------|-------------|----------------|---------|------------|---------|---------|-------|-----------|------------|------------|
| ç”¨æˆ·ç®¡ç† | âœ… å®Œå…¨ | âœ… å®Œå…¨ | ğŸ“– æŸ¥çœ‹ | âŒ | ğŸ“ éƒ¨åˆ† | ğŸ“– æŸ¥çœ‹ | âŒ | âŒ | âŒ | âŒ |
| è®¾å¤‡ç®¡ç† | âœ… å®Œå…¨ | âœ… å®Œå…¨ | âŒ | âœ… å®Œå…¨ | ğŸ“ éƒ¨åˆ† | ğŸ“– æŸ¥çœ‹ | ğŸ“– æŸ¥çœ‹ | âœ… API | âœ… å®Œå…¨ | âœ… åŸºç¡€ |
| è´¢åŠ¡ç®¡ç† | âœ… å®Œå…¨ | ğŸ“– æŸ¥çœ‹ | âœ… å®Œå…¨ | âŒ | âŒ | ğŸ“– æŸ¥çœ‹ | âŒ | âŒ | ğŸ“– æŸ¥çœ‹ | ğŸ“– æŸ¥çœ‹ |
| å·¥å•ç³»ç»Ÿ | âœ… å®Œå…¨ | âœ… å®Œå…¨ | âŒ | âŒ | âœ… å®Œå…¨ | âŒ | âŒ | âŒ | ğŸ“ åˆ›å»º | ğŸ“ åˆ›å»º |
| ä»£ç†å•†ç®¡ç† | âœ… å®Œå…¨ | âœ… å®Œå…¨ | âŒ | âŒ | âŒ | âŒ | âœ… å®¢æˆ· | âŒ | âŒ | âŒ |
| API ç®¡ç† | âœ… å®Œå…¨ | âœ… å®Œå…¨ | âŒ | âŒ | âŒ | âŒ | âŒ | âœ… å®Œå…¨ | âŒ | âŒ |
| æ•°æ®åˆ†æ | âœ… å®Œå…¨ | âœ… å®Œå…¨ | ğŸ’° è´¢åŠ¡ | ğŸ“Š ç³»ç»Ÿ | ğŸ“ˆ åŸºç¡€ | âœ… å®Œå…¨ | ğŸ“ˆ åŸºç¡€ | âŒ | âŒ | âŒ |
| ç³»ç»Ÿç®¡ç† | âœ… å®Œå…¨ | âœ… å®Œå…¨ | âŒ | âœ… å®Œå…¨ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ |

å›¾ä¾‹ï¼š
- âœ… å®Œå…¨æƒé™
- ğŸ“ éƒ¨åˆ†æƒé™ï¼ˆåˆ›å»º+ä¿®æ”¹ï¼‰
- ğŸ“– ä»…æŸ¥çœ‹
- âŒ æ— æƒé™

---

## æƒé™åˆ—è¡¨

### æŒ‰ä¸šåŠ¡æ¨¡å—åˆ†ç»„ï¼ˆå…± 100+ æƒé™ï¼‰

#### 1. ç”¨æˆ·ç®¡ç† (8 ä¸ªæƒé™)

```
user:create              - åˆ›å»ºç”¨æˆ·
user:read                - æŸ¥çœ‹ç”¨æˆ·
user:read_sensitive      - æŸ¥çœ‹ç”¨æˆ·æ•æ„Ÿä¿¡æ¯ï¼ˆå®Œæ•´æ‰‹æœºå·ã€é‚®ç®±ç­‰ï¼‰
user:update              - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
user:delete              - åˆ é™¤ç”¨æˆ·
user:ban                 - ç¦ç”¨/å¯ç”¨ç”¨æˆ·è´¦å·
user:reset_password      - é‡ç½®ç”¨æˆ·å¯†ç 
user:export              - å¯¼å‡ºç”¨æˆ·æ•°æ®
```

#### 2. è®¾å¤‡ç®¡ç† (7 ä¸ªæƒé™)

```
device:create            - åˆ›å»ºè®¾å¤‡
device:read              - æŸ¥çœ‹è®¾å¤‡
device:update            - æ›´æ–°è®¾å¤‡é…ç½®
device:delete            - åˆ é™¤è®¾å¤‡
device:control           - æ§åˆ¶è®¾å¤‡ï¼ˆå¯åŠ¨/åœæ­¢/é‡å¯ï¼‰
device:console           - è®¿é—®è®¾å¤‡æ§åˆ¶å°ï¼ˆVNC/ADBï¼‰
device:export            - å¯¼å‡ºè®¾å¤‡æ•°æ®
```

#### 3. åº”ç”¨ç®¡ç† (7 ä¸ªæƒé™)

```
app:create               - ä¸Šä¼ åº”ç”¨
app:read                 - æŸ¥çœ‹åº”ç”¨
app:update               - æ›´æ–°åº”ç”¨
app:delete               - åˆ é™¤åº”ç”¨
app:install              - å®‰è£…åº”ç”¨åˆ°è®¾å¤‡
app:uninstall            - å¸è½½åº”ç”¨
app:export               - å¯¼å‡ºåº”ç”¨åˆ—è¡¨
```

#### 4. è®¢å•ç®¡ç† (5 ä¸ªæƒé™)

```
order:create             - åˆ›å»ºè®¢å•
order:read               - æŸ¥çœ‹è®¢å•
order:update             - æ›´æ–°è®¢å•
order:cancel             - å–æ¶ˆè®¢å•
order:export             - å¯¼å‡ºè®¢å•æ•°æ®
```

#### 5. è´¦å•ç®¡ç† (4 ä¸ªæƒé™)

```
billing:read             - æŸ¥çœ‹è´¦å•
billing:read_all         - æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·è´¦å•ï¼ˆè´¢åŠ¡ï¼‰
billing:update           - ä¿®æ”¹è´¦å•çŠ¶æ€
billing:export           - å¯¼å‡ºè´¦å•æ•°æ®ï¼ˆä¸è„±æ•ï¼‰
```

#### 6. æ”¯ä»˜ç®¡ç† (5 ä¸ªæƒé™)

```
payment:create           - åˆ›å»ºæ”¯ä»˜
payment:read             - æŸ¥çœ‹æ”¯ä»˜è®°å½•
payment:refund           - é€€æ¬¾
payment:approve_refund   - å®¡æ‰¹é€€æ¬¾ç”³è¯·
payment:export           - å¯¼å‡ºæ”¯ä»˜æ•°æ®
```

#### 7. å¥—é¤ç®¡ç† (5 ä¸ªæƒé™)

```
plan:create              - åˆ›å»ºå¥—é¤
plan:read                - æŸ¥çœ‹å¥—é¤
plan:update              - æ›´æ–°å¥—é¤
plan:delete              - åˆ é™¤å¥—é¤
plan:set_price           - è®¾ç½®å¥—é¤ä»·æ ¼
```

#### 8. å·¥å•ç³»ç»Ÿ (6 ä¸ªæƒé™)

```
ticket:create            - åˆ›å»ºå·¥å•
ticket:read              - æŸ¥çœ‹å·¥å•
ticket:update            - æ›´æ–°å·¥å•
ticket:assign            - åˆ†é…å·¥å•
ticket:close             - å…³é—­å·¥å•
ticket:export            - å¯¼å‡ºå·¥å•æ•°æ®
```

#### 9. ä»£ç†å•†ç®¡ç† (5 ä¸ªæƒé™)

```
agent:create             - åˆ›å»ºä»£ç†å•†
agent:read               - æŸ¥çœ‹ä»£ç†å•†
agent:update             - æ›´æ–°ä»£ç†å•†ä¿¡æ¯
agent:delete             - åˆ é™¤ä»£ç†å•†
agent:set_pricing        - è®¾ç½®ä»£ç†å•†ä»·æ ¼ç­–ç•¥
```

#### 10. ä»£ç†å•†å®¢æˆ·ç®¡ç† (4 ä¸ªæƒé™)

```
agent_customer:create         - åˆ›å»ºå®¢æˆ·è´¦å·
agent_customer:read           - æŸ¥çœ‹å®¢æˆ·ä¿¡æ¯
agent_customer:update         - æ›´æ–°å®¢æˆ·ä¿¡æ¯
agent_customer:assign_resource - åˆ†é…èµ„æºç»™å®¢æˆ·
```

#### 11. åˆ†æ¶¦ç®¡ç† (5 ä¸ªæƒé™)

```
commission:read               - æŸ¥çœ‹åˆ†æ¶¦è®°å½•
commission:read_all           - æŸ¥çœ‹æ‰€æœ‰ä»£ç†å•†åˆ†æ¶¦ï¼ˆè´¢åŠ¡ï¼‰
commission:withdraw           - ç”³è¯·æç°
commission:approve_withdraw   - å®¡æ‰¹æç°ç”³è¯·
commission:export             - å¯¼å‡ºåˆ†æ¶¦æ•°æ®
```

#### 12. API å¯†é’¥ç®¡ç† (4 ä¸ªæƒé™)

```
api_key:create           - åˆ›å»º API å¯†é’¥
api_key:read             - æŸ¥çœ‹ API å¯†é’¥
api_key:delete           - åˆ é™¤ API å¯†é’¥
api_key:rotate           - è½®æ¢ API å¯†é’¥
```

#### 13. API é…é¢ç®¡ç† (2 ä¸ªæƒé™)

```
api_quota:read           - æŸ¥çœ‹ API é…é¢
api_quota:update         - æ›´æ–° API é…é¢
```

#### 14. API è°ƒç”¨æ—¥å¿— (2 ä¸ªæƒé™)

```
api_log:read             - æŸ¥çœ‹ API è°ƒç”¨æ—¥å¿—
api_log:export           - å¯¼å‡º API è°ƒç”¨æ—¥å¿—
```

#### 15. Webhook ç®¡ç† (5 ä¸ªæƒé™)

```
webhook:create           - åˆ›å»º Webhook
webhook:read             - æŸ¥çœ‹ Webhook
webhook:update           - æ›´æ–° Webhook
webhook:delete           - åˆ é™¤ Webhook
webhook:test             - æµ‹è¯• Webhook
```

#### 16. æ•°æ®åˆ†æ (4 ä¸ªæƒé™)

```
analytics:read_basic     - æŸ¥çœ‹åŸºç¡€æ•°æ®åˆ†æ
analytics:read_advanced  - æŸ¥çœ‹é«˜çº§æ•°æ®åˆ†æ
analytics:read_financial - æŸ¥çœ‹è´¢åŠ¡æ•°æ®åˆ†æ
analytics:export         - å¯¼å‡ºåˆ†ææŠ¥è¡¨
```

#### 17. ç³»ç»Ÿç®¡ç† (4 ä¸ªæƒé™)

```
system:settings_read     - æŸ¥çœ‹ç³»ç»Ÿè®¾ç½®
system:settings_update   - æ›´æ–°ç³»ç»Ÿè®¾ç½®
system:node_manage       - ç®¡ç†è®¾å¤‡èŠ‚ç‚¹
system:monitor           - ç³»ç»Ÿç›‘æ§
```

#### 18. è§’è‰²æƒé™ç®¡ç† (20 ä¸ªæƒé™)

```
role:create              - åˆ›å»ºè§’è‰²
role:read                - æŸ¥çœ‹è§’è‰²
role:update              - æ›´æ–°è§’è‰²
role:delete              - åˆ é™¤è§’è‰²
role:assign              - åˆ†é…è§’è‰²

permission:create        - åˆ›å»ºæƒé™
permission:read          - æŸ¥çœ‹æƒé™
permission:update        - æ›´æ–°æƒé™
permission:delete        - åˆ é™¤æƒé™
permission:dataScope:*   - æ•°æ®èŒƒå›´é…ç½®ç›¸å…³
permission:fieldPermission:* - å­—æ®µæƒé™é…ç½®ç›¸å…³
permission:menu:*        - èœå•æƒé™ç›¸å…³
permission:cache:*       - æƒé™ç¼“å­˜ç›¸å…³
```

#### 19. å®¡è®¡æ—¥å¿— (2 ä¸ªæƒé™)

```
audit_log:read           - æŸ¥çœ‹å®¡è®¡æ—¥å¿—
audit_log:export         - å¯¼å‡ºå®¡è®¡æ—¥å¿—
```

---

## æ•°æ®èŒƒå›´ç­–ç•¥

### èŒƒå›´ç±»å‹è¯´æ˜

| èŒƒå›´ç±»å‹ | è¯´æ˜ | é€‚ç”¨è§’è‰² | ç¤ºä¾‹ |
|----------|------|----------|------|
| `ALL` | å…¨éƒ¨æ•°æ® | Super Admin | æŸ¥çœ‹æ‰€æœ‰ç§Ÿæˆ·çš„æ‰€æœ‰æ•°æ® |
| `TENANT` | ç§Ÿæˆ·æ•°æ® | Platform Admin, Finance, Operations, Support, Analyst | æŸ¥çœ‹æœ¬ç§Ÿæˆ·çš„æ‰€æœ‰æ•°æ® |
| `SELF` | æœ¬äººæ•°æ® | Agent, Developer, Enterprise User, Individual User | åªèƒ½æŸ¥çœ‹è‡ªå·±çš„æ•°æ® |
| `CUSTOM` | è‡ªå®šä¹‰è¿‡æ»¤å™¨ | Agentï¼ˆæŸ¥çœ‹è‡ªå·±å®¢æˆ·çš„æ•°æ®ï¼‰ | é€šè¿‡ agentId è¿‡æ»¤ |

### å„è§’è‰²æ•°æ®èŒƒå›´é…ç½®

#### Super Admin
```yaml
device: ALL          # æ‰€æœ‰è®¾å¤‡
user: ALL            # æ‰€æœ‰ç”¨æˆ·
order: ALL           # æ‰€æœ‰è®¢å•
billing: ALL         # æ‰€æœ‰è´¦å•
```

#### Platform Admin / Finance / Operations / Support / Analyst
```yaml
æ‰€æœ‰èµ„æº: TENANT     # æœ¬ç§Ÿæˆ·æ‰€æœ‰æ•°æ®
```

#### Agentï¼ˆä»£ç†å•†ï¼‰
```yaml
agent_customer: SELF              # è‡ªå·±åˆ›å»ºçš„å®¢æˆ·
commission: SELF                  # è‡ªå·±çš„åˆ†æ¶¦
device: CUSTOM (agentId=$userId)  # è‡ªå·±å®¢æˆ·çš„è®¾å¤‡
order: CUSTOM (agentId=$userId)   # è‡ªå·±å®¢æˆ·çš„è®¢å•
```

#### Developer / Enterprise User / Individual User
```yaml
æ‰€æœ‰èµ„æº: SELF       # åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
```

---

## åˆ†çº§è„±æ•ç­–ç•¥

### ç”¨æˆ·ä¿¡æ¯è„±æ•è§„åˆ™

#### 1. Super Admin / Platform Admin
- **æ•æ„Ÿå­—æ®µ**ï¼šå®Œå…¨å¯è§
- **éšè—å­—æ®µ**ï¼špassword, salt

```json
{
  "username": "zhangsan",
  "email": "zhangsan@example.com",    // å®Œæ•´
  "phone": "13800138000",              // å®Œæ•´
  "idCard": "110101199001011234"       // å®Œæ•´
}
```

#### 2. Finance Manager
- **æ‰‹æœºå·**ï¼šéƒ¨åˆ†è„±æ•ï¼ˆä¿ç•™å‰3å4ä½ï¼‰
- **å…¶ä»–**ï¼šå®Œæ•´å¯è§

```json
{
  "username": "zhangsan",
  "email": "zhangsan@example.com",    // å®Œæ•´
  "phone": "138****8000",              // è„±æ•ï¼š{3}****{4}
  "idCard": "110101199001011234"       // å®Œæ•´
}
```

#### 3. Customer Service
- **æ‰‹æœºå·**ï¼šæ›´å¤šè„±æ•ï¼ˆä»…ä¿ç•™å4ä½ï¼‰
- **é‚®ç®±**ï¼šè„±æ•ï¼ˆä¿ç•™å‰3ä½ï¼‰
- **èº«ä»½è¯**ï¼šè„±æ•ï¼ˆä¿ç•™å‰6å4ä½ï¼‰

```json
{
  "username": "zhangsan",
  "email": "zha***@***",               // è„±æ•ï¼š{3}***@***
  "phone": "***-****-8000",            // è„±æ•ï¼š***-****-{4}
  "idCard": "110101********1234"       // è„±æ•ï¼š{6}********{4}
}
```

#### 4. Data Analyst
- **æ‰€æœ‰æ•æ„Ÿå­—æ®µ**ï¼šå“ˆå¸Œå¤„ç†

```json
{
  "username": "zhangsan",
  "email": "***HASHED***",
  "phone": "***HASHED***",
  "idCard": "***HASHED***",
  "realName": "***HASHED***"
}
```

#### 5. Agent
- **æ‰‹æœºå·ã€é‚®ç®±**ï¼šä¸å®¢æœç›¸åŒç¨‹åº¦è„±æ•

```json
{
  "username": "zhangsan",
  "email": "zha***@***",
  "phone": "***-****-8000"
}
```

### è®¾å¤‡ä¿¡æ¯è„±æ•

#### Operations Manager
- å¯æŸ¥çœ‹æ‰€æœ‰å­—æ®µï¼ˆåŒ…æ‹¬å†…éƒ¨ä¿¡æ¯ï¼‰

```json
{
  "name": "Device-001",
  "ipAddress": "192.168.1.100",
  "internalIp": "10.0.0.100",         // å¯è§
  "nodeId": "node-001",                // å¯è§
  "containerId": "abc123"              // å¯è§
}
```

#### Enterprise User / Individual User
- éšè—å†…éƒ¨ä¿¡æ¯

```json
{
  "name": "Device-001",
  "ipAddress": "192.168.1.100",
  "internalIp": "HIDDEN",              // éšè—
  "nodeId": "HIDDEN",                  // éšè—
  "containerId": "HIDDEN"              // éšè—
}
```

### è´¢åŠ¡æ•°æ®å¯¼å‡º

**Finance Manager å¯¼å‡ºæ—¶ä¸è„±æ•**ï¼š
- å¯¼å‡ºè´¦å•ã€è®¢å•ã€æ”¯ä»˜æ•°æ®æ—¶æ˜¾ç¤ºå®Œæ•´ä¿¡æ¯
- ç”¨äºè´¢åŠ¡å¯¹è´¦å’Œå®¡è®¡

---

## åˆå§‹åŒ–æ­¥éª¤

### 1. ç¡®ä¿æ•°æ®åº“å·²åˆ›å»º

```bash
# PostgreSQL åˆ›å»ºæ•°æ®åº“
createdb cloudphone
```

### 2. è¿è¡Œå®šåˆ¶åŒ–åˆå§‹åŒ–è„šæœ¬

```bash
cd backend/user-service

# è¿è¡Œå®šåˆ¶åŒ–æƒé™åˆå§‹åŒ–
npm run init:permissions:custom
```

### 3. æŸ¥çœ‹åˆå§‹åŒ–ç»“æœ

é¢„æœŸè¾“å‡ºï¼š

```
ğŸš€ å¼€å§‹åˆå§‹åŒ–å®šåˆ¶åŒ–æƒé™ç³»ç»Ÿ...

ä¸šåŠ¡åœºæ™¯ï¼šB2B + B2C + ä»£ç†å•† + å¼€å‘è€…
ç»„ç»‡æ¶æ„ï¼šæ‰å¹³åŒ–ï¼ˆæ— éƒ¨é—¨å±‚çº§ï¼‰
æ•°æ®å®‰å…¨ï¼šåˆ†çº§è„±æ•

âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ

ğŸ”‘ åˆå§‹åŒ–æƒé™...
  âœ… åˆ›å»ºæƒé™: user:create
  âœ… åˆ›å»ºæƒé™: user:read
  ... (100+ æƒé™)

ğŸ“Š å…±åˆ›å»º/æ£€æŸ¥ 100+ ä¸ªæƒé™

ğŸ‘¥ åˆå§‹åŒ–è§’è‰²...
  âœ… åˆ›å»ºè§’è‰²: Super Admin
  âœ… åˆ›å»ºè§’è‰²: Platform Admin
  ... (10 ä¸ªè§’è‰²)

ğŸ“Š åˆå§‹åŒ–æ•°æ®èŒƒå›´é…ç½®...
  âœ… super_admin - device (ALL)
  âœ… platform_admin - device (TENANT)
  ... (40+ é…ç½®)

ğŸ”’ åˆå§‹åŒ–å­—æ®µæƒé™é…ç½®ï¼ˆåˆ†çº§è„±æ•ï¼‰...
  âœ… super_admin - user - VIEW
  âœ… finance_manager - user - VIEW
  ... (10+ é…ç½®)

ğŸ‘¤ åˆ›å»ºæµ‹è¯•è´¦å·...
  âœ… admin / admin123 (Super Admin)
  âœ… platform_admin / platform123 (Platform Admin)
  ... (10 ä¸ªè´¦å·)

============================================================
âœ… å®šåˆ¶åŒ–æƒé™ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆï¼
============================================================

ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:
  - æƒé™æ•°é‡: 100+
  - è§’è‰²æ•°é‡: 10
  - æ•°æ®èŒƒå›´é…ç½®: 40+
  - å­—æ®µæƒé™é…ç½®: 10+
  - æµ‹è¯•è´¦å·æ•°: 10 ä¸ª
```

---

## æµ‹è¯•è´¦å·

### 10 ä¸ªé¢„åˆ›å»ºæµ‹è¯•è´¦å·

| åºå· | ç”¨æˆ·å | å¯†ç  | è§’è‰² | ç”¨é€” |
|------|--------|------|------|------|
| 1 | `admin` | `admin123` | Super Admin | è¶…çº§ç®¡ç†å‘˜ |
| 2 | `platform_admin` | `platform123` | Platform Admin | å¹³å°ç®¡ç†å‘˜ |
| 3 | `finance` | `finance123` | Finance Manager | è´¢åŠ¡ç®¡ç†å‘˜ |
| 4 | `operations` | `ops123` | Operations Manager | è¿ç»´ç®¡ç†å‘˜ |
| 5 | `support` | `support123` | Customer Service | å®¢æœäººå‘˜ |
| 6 | `analyst` | `analyst123` | Data Analyst | æ•°æ®åˆ†æå¸ˆ |
| 7 | `agent001` | `agent123` | Agent | ä»£ç†å•† |
| 8 | `developer` | `dev123` | Developer | å¼€å‘è€… |
| 9 | `enterprise_user` | `enterprise123` | Enterprise User | ä¼ä¸šç”¨æˆ· |
| 10 | `user` | `user123` | Individual User | ä¸ªäººç”¨æˆ· |

âš ï¸ **å®‰å…¨æç¤º**ï¼š
- è¿™äº›æ˜¯æµ‹è¯•è´¦å·ï¼Œä»…ç”¨äºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ
- **ç”Ÿäº§ç¯å¢ƒå¿…é¡»ç«‹å³ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†ç **
- å»ºè®®å¯ç”¨åŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šè´¢åŠ¡ç®¡ç†å‘˜æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯

**ç™»å½•è´¦å·**ï¼š`finance` / `finance123`

**æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨**ï¼š
```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  http://localhost:30001/users
```

**è¿”å›æ•°æ®ï¼ˆè‡ªåŠ¨è„±æ•ï¼‰**ï¼š
```json
{
  "data": [
    {
      "id": "user-001",
      "username": "zhangsan",
      "email": "zhangsan@example.com",
      "phone": "138****8000",           // éƒ¨åˆ†è„±æ•
      "idCard": "110101199001011234"    // å®Œæ•´ï¼ˆè´¢åŠ¡éœ€è¦ï¼‰
    }
  ]
}
```

### ç¤ºä¾‹ 2ï¼šå®¢æœæŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯

**ç™»å½•è´¦å·**ï¼š`support` / `support123`

**æŸ¥çœ‹åŒæ ·çš„ç”¨æˆ·**ï¼š
```json
{
  "data": [
    {
      "id": "user-001",
      "username": "zhangsan",
      "email": "zha***@***",            // æ›´å¤šè„±æ•
      "phone": "***-****-8000",         // æ›´å¤šè„±æ•
      "idCard": "110101********1234"    // è„±æ•
    }
  ]
}
```

### ç¤ºä¾‹ 3ï¼šä»£ç†å•†æŸ¥çœ‹å®¢æˆ·

**ç™»å½•è´¦å·**ï¼š`agent001` / `agent123`

**åˆ›å»ºå®¢æˆ·**ï¼š
```bash
curl -X POST \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "customer001",
    "email": "customer@example.com",
    "phone": "13900139000"
  }' \
  http://localhost:30001/agent-customers
```

**æŸ¥çœ‹è‡ªå·±çš„å®¢æˆ·åˆ—è¡¨**ï¼š
```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  http://localhost:30001/agent-customers
```

**åªèƒ½çœ‹åˆ°è‡ªå·±åˆ›å»ºçš„å®¢æˆ·**ï¼š
```json
{
  "data": [
    {
      "id": "customer-001",
      "username": "customer001",
      "agentId": "agent001",           // å½“å‰ä»£ç†å•†ID
      "email": "cus***@***",           // è„±æ•
      "phone": "***-****-9000"         // è„±æ•
    }
  ]
}
```

### ç¤ºä¾‹ 4ï¼šå¼€å‘è€…ä½¿ç”¨ API

**ç™»å½•è´¦å·**ï¼š`developer` / `dev123`

**åˆ›å»º API å¯†é’¥**ï¼š
```bash
curl -X POST \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "My API Key",
    "expiresAt": "2025-12-31"
  }' \
  http://localhost:30001/api-keys
```

**è¿”å›**ï¼š
```json
{
  "id": "key-001",
  "name": "My API Key",
  "apiKey": "pk_live_xxxxxxxxxxxxxxxxxx",
  "apiSecret": "sk_live_xxxxxxxxxxxxxxxxxx"
}
```

**é€šè¿‡ API åˆ›å»ºè®¾å¤‡**ï¼š
```bash
curl -X POST \
  -H "X-API-Key: pk_live_xxxxxxxxxxxxxxxxxx" \
  -H "X-API-Secret: sk_live_xxxxxxxxxxxxxxxxxx" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Test Device",
    "planId": "plan-001"
  }' \
  http://localhost:30001/devices
```

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•ä¿®æ”¹æµ‹è¯•è´¦å·å¯†ç ï¼Ÿ

**A**: ä½¿ç”¨ä»¥ä¸‹ APIï¼š

```bash
curl -X PUT \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "oldPassword": "admin123",
    "newPassword": "NewSecurePassword123!"
  }' \
  http://localhost:30001/auth/change-password
```

### Q2: ä»£ç†å•†å¦‚ä½•è®¾ç½®å®¢æˆ·çš„ä»·æ ¼ï¼Ÿ

**A**: éœ€è¦ç®¡ç†å‘˜å…ˆä¸ºä»£ç†å•†é…ç½®ä»·æ ¼ç­–ç•¥ï¼š

```bash
curl -X POST \
  -H "Authorization: Bearer ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "agentId": "agent001",
    "planId": "plan-001",
    "price": 98.00,
    "commission": 0.15
  }' \
  http://localhost:30001/agents/pricing
```

### Q3: å¦‚ä½•æŸ¥çœ‹ä»£ç†å•†çš„åˆ†æ¶¦æ•°æ®ï¼Ÿ

**A**:
- **ä»£ç†å•†**ï¼šæŸ¥çœ‹è‡ªå·±çš„åˆ†æ¶¦
```bash
curl -H "Authorization: Bearer AGENT_TOKEN" \
  http://localhost:30001/commissions
```

- **è´¢åŠ¡ç®¡ç†å‘˜**ï¼šæŸ¥çœ‹æ‰€æœ‰ä»£ç†å•†åˆ†æ¶¦
```bash
curl -H "Authorization: Bearer FINANCE_TOKEN" \
  http://localhost:30001/commissions/all
```

### Q4: å¼€å‘è€…å¦‚ä½•é…ç½® Webhookï¼Ÿ

**A**:

```bash
curl -X POST \
  -H "Authorization: Bearer DEVELOPER_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://example.com/webhooks",
    "events": ["device.created", "device.started", "device.stopped"],
    "secret": "your_webhook_secret"
  }' \
  http://localhost:30001/webhooks
```

### Q5: å¦‚ä½•é™åˆ¶ API è°ƒç”¨æ¬¡æ•°ï¼Ÿ

**A**: ç®¡ç†å‘˜ä¸ºå¼€å‘è€…è®¾ç½®é…é¢ï¼š

```bash
curl -X PUT \
  -H "Authorization: Bearer ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "userId": "developer-001",
    "dailyLimit": 10000,
    "hourlyLimit": 1000
  }' \
  http://localhost:30001/api-quotas
```

---

## ä¸‹ä¸€æ­¥

1. **æµ‹è¯•æƒé™ç³»ç»Ÿ**ï¼šä½¿ç”¨ä¸åŒè´¦å·ç™»å½•ï¼ŒéªŒè¯æƒé™å’Œæ•°æ®èŒƒå›´
2. **å®šåˆ¶åŒ–è°ƒæ•´**ï¼šæ ¹æ®å®é™…éœ€è¦è°ƒæ•´è§’è‰²æƒé™
3. **é›†æˆåˆ°ä¸šåŠ¡ä»£ç **ï¼šåœ¨å„ä¸ªæ¨¡å—ä¸­åº”ç”¨æƒé™æ§åˆ¶
4. **ç›‘æ§å’Œå®¡è®¡**ï¼šæŸ¥çœ‹å®¡è®¡æ—¥å¿—ï¼Œç¡®ä¿æƒé™ç³»ç»Ÿæ­£å¸¸è¿è¡Œ

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**æœ€åæ›´æ–°**: 2025-10-21
**ç»´æŠ¤è€…**: Claude Code

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹å®Œæ•´ä½¿ç”¨æŒ‡å—ï¼š`/docs/PERMISSION_USAGE_GUIDE.md`
