# 流媒体服务环境变量配置 (Go)

# 运行环境
ENVIRONMENT=development
PORT=30006
GIN_MODE=debug
LOG_LEVEL=info

# Redis 配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# WebRTC 配置
STUN_SERVERS=stun:stun.l.google.com:19302,stun:stun1.l.google.com:19302
TURN_URLS=
TURN_USERNAME=
TURN_CREDENTIAL=

# ICE 配置
ICE_PORT_MIN=50000
ICE_PORT_MAX=50100

# 视频编码配置
VIDEO_CODEC=VP8
MAX_BITRATE=2000000  # 2Mbps
MAX_FRAME_RATE=30
VIDEO_WIDTH=1280
VIDEO_HEIGHT=720

# 采集模式配置 (优化重点!)
# screenrecord: H.264 硬件编码 (推荐) - 延迟50-100ms, 30fps+, CPU使用低
# screencap: PNG 逐帧采集 - 延迟200-500ms, 15-20fps, CPU使用高
CAPTURE_MODE=screenrecord

# 编码器类型 (与 CAPTURE_MODE 配合)
# passthrough: 直通 (适用于 screenrecord H.264)
# vp8: VP8 软件编码 (适用于 screencap PNG)
# vp8-simple: 简单 VP8 编码
# h264: H.264 软件编码
VIDEO_ENCODER_TYPE=passthrough

# 音频编码配置
AUDIO_CODEC=opus

# HLS 配置 (可选)
HLS_ENABLED=false
HLS_SEGMENT_DURATION=6  # seconds
HLS_PLAYLIST_LENGTH=5  # segments
HLS_OUTPUT_DIR=/tmp/hls

# WebSocket 配置
WS_READ_BUFFER_SIZE=4096
WS_WRITE_BUFFER_SIZE=4096
WS_PING_INTERVAL=30  # seconds
WS_PONG_TIMEOUT=10  # seconds

# 连接管理
MAX_CONNECTIONS=1000
CONNECTION_TIMEOUT=300  # seconds
IDLE_TIMEOUT=600  # seconds

# 带宽限制
ENABLE_BANDWIDTH_LIMIT=true
MAX_BANDWIDTH_PER_CONNECTION=5000000  # 5Mbps

# 录制配置 (可选)
ENABLE_RECORDING=false
RECORDING_OUTPUT_DIR=/var/recordings
RECORDING_FORMAT=mp4
RECORDING_QUALITY=high  # low | medium | high

# 性能配置
GO_MAX_PROCS=0  # 0 = use all CPUs
GOMEMLIMIT=4GiB

# 日志配置
LOG_LEVEL=INFO  # DEBUG | INFO | WARN | ERROR
LOG_FORMAT=json  # json | text
LOG_FILE=/var/log/media-service.log

# 监控配置
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9092

# 设备服务地址
DEVICE_SERVICE_URL=http://localhost:30002
