# 动态配置表单测试检查清单

## 测试环境
- 前端服务器: http://localhost:50401
- 测试页面: http://localhost:50401/#/proxy/config
- 完成时间: 2025-11-24

## 功能测试

### 1. IPIDEA 提供商 (7个字段)

**测试步骤**:
1. 点击"添加供应商"按钮
2. 填写供应商名称: `IPIDEA 测试`
3. 选择供应商类型: `IPIDEA (推荐)`
4. 验证自动显示的字段:
   - [ ] AppKey (API 密钥) - 密码输入框 ✓
   - [ ] 代理认证用户名 - 文本输入框 ✓
   - [ ] 代理认证密码 - 密码输入框 ✓
   - [ ] 专属网关地址 - 文本输入框（全宽）✓
   - [ ] 端口 - 下拉选择（默认2336）✓
   - [ ] API 地址 - URL输入框（默认 https://api.ipidea.net）✓
   - [ ] 代理类型 - 下拉选择（默认 residential）✓

**字段验证**:
- [ ] AppKey 必填验证
- [ ] 网关地址正则验证（*.lqz.na.ipidea.online）
- [ ] 端口默认值 2336
- [ ] API 地址默认值自动填充
- [ ] 代理类型默认值 residential

**提交测试**:
1. [ ] 填写所有必填字段
2. [ ] 点击"确定"按钮
3. [ ] 验证数据提交格式正确（查看 Network 请求）
4. [ ] 验证列表显示新添加的配置

---

### 2. Kookeey 提供商 (3个字段)

**测试步骤**:
1. 点击"添加供应商"按钮
2. 填写供应商名称: `Kookeey 测试`
3. 选择供应商类型: `Kookeey (家宽代理)`
4. 验证自动显示的字段:
   - [ ] Developer ID (Access ID) - 文本输入框 ✓
   - [ ] Developer Token - 密码输入框 ✓
   - [ ] API 地址 - URL输入框（默认 https://kookeey.com）✓

**字段验证**:
- [ ] Access ID 必填验证
- [ ] Token 必填验证
- [ ] API 地址默认值自动填充

---

### 3. Bright Data 提供商 (5个字段)

**测试步骤**:
1. 选择供应商类型: `Bright Data`
2. 验证字段:
   - [ ] API Key - 密码输入框 ✓
   - [ ] 用户名 - 文本输入框（占位符提示格式）✓
   - [ ] 密码 - 密码输入框 ✓
   - [ ] Zone (代理池) - 下拉选择（默认 residential）✓
   - [ ] API 地址 - URL输入框（默认值）✓

---

### 4. Oxylabs 提供商 (4个字段)

**测试步骤**:
1. 选择供应商类型: `Oxylabs`
2. 验证字段:
   - [ ] API Key - 密码输入框 ✓
   - [ ] 用户名 - 文本输入框 ✓
   - [ ] 密码 - 密码输入框 ✓
   - [ ] API 地址 - URL输入框（默认 https://realtime.oxylabs.io）✓

---

### 5. IPRoyal 提供商 (4个字段)

**测试步骤**:
1. 选择供应商类型: `IPRoyal`
2. 验证字段:
   - [ ] API Key - 密码输入框 ✓
   - [ ] 用户名 - 文本输入框 ✓
   - [ ] 密码 - 密码输入框 ✓
   - [ ] API 地址 - URL输入框（默认 https://api.iproyal.com）✓

---

### 6. SmartProxy 提供商 (4个字段)

**测试步骤**:
1. 选择供应商类型: `SmartProxy`
2. 验证字段:
   - [ ] API Key - 密码输入框 ✓
   - [ ] 用户名 - 文本输入框 ✓
   - [ ] 密码 - 密码输入框 ✓
   - [ ] API 地址 - URL输入框（默认 https://api.smartproxy.com）✓

---

## 模式切换测试

### 表单模式 → JSON 模式

**测试步骤**:
1. [ ] 选择 IPIDEA 提供商
2. [ ] 填写所有字段（使用测试数据）
3. [ ] 点击"JSON 模式"按钮
4. [ ] 验证所有字段值正确转换为 JSON 格式
5. [ ] 验证 JSON 格式化（缩进2空格）
6. [ ] 验证空字段未包含在 JSON 中

**预期 JSON 结构**:
```json
{
  "apiKey": "test-key",
  "username": "test-user",
  "password": "test-pass",
  "gateway": "xxx.lqz.na.ipidea.online",
  "port": 2336,
  "apiUrl": "https://api.ipidea.net",
  "proxyType": "residential"
}
```

---

### JSON 模式 → 表单模式

**测试步骤**:
1. [ ] 在 JSON 模式下粘贴完整配置
2. [ ] 点击"表单模式"按钮
3. [ ] 验证 JSON 正确解析到各个字段
4. [ ] 验证所有字段值正确显示
5. [ ] 测试 JSON 解析失败场景（格式错误）

---

## 编辑功能测试

### 编辑已有配置

**测试步骤**:
1. [ ] 在列表中点击某个配置的"编辑"按钮
2. [ ] 验证所有基本信息正确回填（name, type, priority, costPerGB, enabled）
3. [ ] 验证 config 字段正确展开到表单
4. [ ] 验证提供商类型下拉框被禁用（防止类型冲突）
5. [ ] 修改某些字段
6. [ ] 点击"确定"提交
7. [ ] 验证更新成功

---

## 验证功能测试

### 必填字段验证

**测试步骤**:
1. [ ] 留空必填字段，尝试提交
2. [ ] 验证显示"请输入XXX"错误提示
3. [ ] 验证表单无法提交

### 正则验证（IPIDEA 网关）

**测试步骤**:
1. [ ] 输入无效网关地址: `invalid-gateway.com`
2. [ ] 验证显示"请输入有效的 IPIDEA 网关地址"错误
3. [ ] 输入有效网关: `abc123.lqz.na.ipidea.online`
4. [ ] 验证通过

### URL 格式验证

**测试步骤**:
1. [ ] 在 API 地址字段输入无效 URL: `not-a-url`
2. [ ] 验证显示"请输入有效的 URL"错误
3. [ ] 输入有效 URL: `https://api.example.com`
4. [ ] 验证通过

### JSON 格式验证（高级模式）

**测试步骤**:
1. [ ] 切换到 JSON 模式
2. [ ] 输入无效 JSON: `{invalid json}`
3. [ ] 验证显示"JSON 格式不正确"错误
4. [ ] 输入有效 JSON
5. [ ] 验证通过

---

## UI/UX 测试

### 响应式布局

**测试步骤**:
1. [ ] 验证两列布局（12/12）的字段正确显示
2. [ ] 验证全宽字段（gateway, apiUrl）占据整行
3. [ ] 验证 Row gutter 间距正确

### 提示信息

**测试步骤**:
1. [ ] 悬停在问号图标上
2. [ ] 验证 Tooltip 提示信息显示
3. [ ] 验证提示信息内容准确

### 占位符

**测试步骤**:
1. [ ] 验证所有字段有清晰的占位符
2. [ ] 验证占位符提供示例格式

### 模式切换按钮

**测试步骤**:
1. [ ] 验证"表单模式"按钮在表单模式下为 primary 类型
2. [ ] 验证"JSON 模式"按钮在 JSON 模式下为 primary 类型
3. [ ] 验证按钮图标正确（FormOutlined / CodeOutlined）

### Alert 提示

**测试步骤**:
1. [ ] 打开添加对话框（未选择提供商类型）
2. [ ] 验证显示"请先选择供应商类型"提示
3. [ ] 选择提供商类型后提示消失

---

## 数据提交测试

### 创建新配置

**测试步骤**:
1. [ ] 填写完整表单
2. [ ] 点击"确定"
3. [ ] 打开浏览器 DevTools → Network 标签
4. [ ] 验证请求 payload 结构:
```json
{
  "name": "...",
  "type": "ipidea",
  "enabled": true,
  "priority": 100,
  "costPerGB": 10.00,
  "config": {
    "apiKey": "...",
    "username": "...",
    // ... 其他配置字段
  }
}
```

### 更新已有配置

**测试步骤**:
1. [ ] 编辑已有配置
2. [ ] 修改某些字段
3. [ ] 提交
4. [ ] 验证 PATCH/PUT 请求正确
5. [ ] 验证列表数据更新

---

## 性能测试

### 字段渲染性能

**测试步骤**:
1. [ ] 打开 React DevTools Profiler
2. [ ] 切换不同提供商类型
3. [ ] 验证 DynamicConfigForm 正确使用 memo
4. [ ] 验证不必要的重渲染已优化

### 模式切换性能

**测试步骤**:
1. [ ] 在表单和 JSON 模式间快速切换
2. [ ] 验证切换流畅无卡顿
3. [ ] 验证数据转换正确

---

## 边界情况测试

### 空值处理

**测试步骤**:
1. [ ] 提交包含空字段的表单
2. [ ] 验证空值不包含在 config 对象中
3. [ ] 验证后端接受请求

### 特殊字符处理

**测试步骤**:
1. [ ] 在密码字段输入特殊字符: `!@#$%^&*()`
2. [ ] 验证正确保存和显示
3. [ ] 在 JSON 模式下验证正确转义

### 长文本处理

**测试步骤**:
1. [ ] 输入超长网关地址
2. [ ] 验证输入框和显示正常
3. [ ] 验证不会破坏布局

---

## 回归测试

### 原有功能未破坏

**测试步骤**:
1. [ ] 列表显示正常（供应商名称、标签、统计数据）
2. [ ] 排序功能正常
3. [ ] 操作按钮正常（编辑、测试、启用/禁用、删除）
4. [ ] 总览统计卡片正常
5. [ ] 刷新按钮正常
6. [ ] 分页正常

---

## 测试结果

**总体评分**: _____ / 100

**发现的问题**:
1.
2.
3.

**优化建议**:
1.
2.
3.

**测试人员**: __________
**测试日期**: __________
**测试通过**: [ ] 是 / [ ] 否
