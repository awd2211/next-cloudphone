import { Card, Tabs } from 'antd';
import { LoginForm, RegisterForm, TwoFactorModal } from '@/components/Auth';
import { useLogin } from '@/hooks/useLogin';

const Login = () => {
  const {
    loginForm,
    registerForm,
    loading,
    captchaSvg,
    captchaLoading,
    twoFactorModalVisible,
    twoFactorToken,
    handleLogin,
    handleRegister,
    fetchCaptcha,
    handle2FAVerify,
    handle2FACancel,
    setTwoFactorToken,
  } = useLogin();

  const tabItems = [
    {
      key: 'login',
      label: '登录',
      children: (
        <LoginForm
          form={loginForm}
          loading={loading}
          captchaSvg={captchaSvg}
          captchaLoading={captchaLoading}
          onFinish={handleLogin}
          onRefreshCaptcha={fetchCaptcha}
        />
      ),
    },
    {
      key: 'register',
      label: '注册',
      children: (
        <RegisterForm
          form={registerForm}
          loading={loading}
          onFinish={handleRegister}
        />
      ),
    },
  ];

  return (
    <div
      style={{
        minHeight: '100vh',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
      }}
    >
      <Card
        style={{
          width: 400,
          boxShadow: '0 8px 16px rgba(0, 0, 0, 0.1)',
        }}
      >
        <div style={{ textAlign: 'center', marginBottom: 24 }}>
          <h1 style={{ fontSize: 28, fontWeight: 'bold', margin: 0 }}>云手机平台</h1>
          <p style={{ color: '#999', marginTop: 8 }}>随时随地，轻松使用云端手机</p>
        </div>

        <Tabs items={tabItems} centered />
      </Card>

      <TwoFactorModal
        visible={twoFactorModalVisible}
        loading={loading}
        token={twoFactorToken}
        onTokenChange={setTwoFactorToken}
        onVerify={handle2FAVerify}
        onCancel={handle2FACancel}
      />
    </div>
  );
};

export default Login;
